<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>UNordinary Hub - Admin Panel</title>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --accent-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            --success-gradient: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            --dark-bg: #0a0a0a;
            --card-bg: rgba(255, 255, 255, 0.08);
            --text-primary: #ffffff;
            --text-secondary: #b0b0b0;
            --border: rgba(255, 255, 255, 0.1);
            --shadow: 0 20px 40px rgba(0, 0, 0, 0.4);
            --glow: 0 0 30px rgba(102, 126, 234, 0.3);
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--dark-bg);
            color: var(--text-primary);
            line-height: 1.6;
            overflow-x: hidden;
            position: relative;
            min-height: 100vh;
        }

        /* Animated Background */
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 80%, rgba(120, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 119, 198, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(120, 255, 214, 0.2) 0%, transparent 50%);
            animation: backgroundShift 20s ease-in-out infinite;
            z-index: -1;
        }

        @keyframes backgroundShift {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 0.6; }
        }

        .admin-container {
            min-height: 100vh;
            padding: 2rem;
            max-width: 1400px;
            margin: 0 auto;
        }

        .admin-header {
            text-align: center;
            margin-bottom: 3rem;
        }

        .admin-header h1 {
            background: var(--primary-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            font-size: 2.5rem;
            margin-bottom: 0.5rem;
        }

        .admin-header p {
            color: var(--text-secondary);
            font-size: 1.1rem;
        }

        .admin-icon {
            font-size: 4rem;
            background: var(--accent-gradient);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 1rem;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        .security-status {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .status-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .status-card.secure {
            border-color: #4CAF50;
            background: rgba(76, 175, 80, 0.1);
        }

        .status-card i {
            font-size: 2rem;
            color: #667eea;
            margin-bottom: 1rem;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        .stat-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }

        .stat-card:hover {
            transform: translateY(-5px);
        }

        .stat-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.5rem;
        }

        .stat-content h3 {
            font-size: 2rem;
            margin: 0;
            color: #fff;
        }

        .stat-content p {
            margin: 0.25rem 0;
            color: #b0b0b0;
        }

        .stat-content small {
            color: #667eea;
            font-size: 0.8rem;
        }

        .admin-actions {
            margin-bottom: 3rem;
        }

        .admin-actions h2 {
            margin-bottom: 1.5rem;
            color: #fff;
        }

        .action-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
        }

        .action-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 2rem;
            text-align: center;
            backdrop-filter: blur(10px);
            transition: transform 0.3s ease;
        }

        .action-card:hover {
            transform: translateY(-5px);
        }

        .action-card i {
            font-size: 3rem;
            color: #667eea;
            margin-bottom: 1rem;
        }

        .action-card h3 {
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .action-card p {
            color: #b0b0b0;
            margin-bottom: 1.5rem;
        }

        .btn {
            padding: 0.75rem 1.5rem;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-decoration: none;
            display: inline-block;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
        }

        .btn-warning {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            color: white;
        }

        .btn-info {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
        }

        .btn-secondary {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .recent-activity, .system-health {
            margin-bottom: 3rem;
        }

        .recent-activity h2, .system-health h2 {
            margin-bottom: 1.5rem;
            color: #fff;
        }

        .activity-list {
            display: grid;
            gap: 1rem;
        }

        .activity-item {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1rem;
            display: flex;
            align-items: center;
            gap: 1rem;
            backdrop-filter: blur(10px);
        }

        .activity-icon {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
        }

        .activity-content h4 {
            margin: 0;
            color: #fff;
        }

        .activity-content p {
            margin: 0;
            color: #b0b0b0;
            font-size: 0.9rem;
        }

        .health-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
        }

        .health-card {
            background: rgba(255, 255, 255, 0.08);
            border: 1px solid var(--border);
            border-radius: 12px;
            padding: 1.5rem;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .health-card h3 {
            margin-bottom: 1rem;
            color: #fff;
        }

        .health-indicator {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .health-indicator.online .dot {
            width: 12px;
            height: 12px;
            background: #4CAF50;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .health-indicator.warning .dot {
            width: 12px;
            height: 12px;
            background: #ffc107;
            border-radius: 50%;
            animation: pulse 2s infinite;
        }

        .health-indicator.critical .dot {
            width: 12px;
            height: 12px;
            background: #dc3545;
            border-radius: 50%;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            backdrop-filter: blur(5px);
        }

        .modal-content {
            background: rgba(10, 10, 10, 0.95);
            margin: 5% auto;
            padding: 2rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 12px;
            width: 80%;
            max-width: 800px;
            max-height: 80vh;
            overflow-y: auto;
            backdrop-filter: blur(20px);
        }

        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }

        .close:hover {
            color: #fff;
        }

        .modal-body {
            margin-top: 1rem;
        }

        .db-section, .user-stats, .user-list, .warning-list, .security-config, .security-events, .command-form, .command-history, .audit-filters, .audit-logs {
            margin-bottom: 1.5rem;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
        }

        .db-section h3, .user-stats h3, .user-list h3, .warning-list h3, .security-config h3, .security-events h3, .command-form h3, .command-history h3 {
            margin-bottom: 0.5rem;
            color: #fff;
        }

        .form-group {
            margin-bottom: 1rem;
        }

        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            color: #fff;
            font-weight: 600;
        }

        .form-group input, .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            font-size: 1rem;
        }

        .form-group input:focus, .form-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .audit-filters {
            display: flex;
            gap: 0.5rem;
            flex-wrap: wrap;
        }

        .log-entry {
            background: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 8px;
            padding: 1rem;
            margin-bottom: 0.5rem;
        }

        .log-entry .log-time {
            color: #b0b0b0;
            font-size: 0.8rem;
        }

        .log-entry .log-action {
            color: #667eea;
            font-weight: 600;
        }

        .log-entry .log-details {
            color: #fff;
            margin-top: 0.5rem;
        }

        .loading {
            text-align: center;
            padding: 2rem;
            color: #b0b0b0;
        }

        .error-message {
            background: rgba(220, 53, 69, 0.1);
            border: 1px solid rgba(220, 53, 69, 0.3);
            color: #dc3545;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        .success-message {
            background: rgba(40, 167, 69, 0.1);
            border: 1px solid rgba(40, 167, 69, 0.3);
            color: #28a745;
            padding: 1rem;
            border-radius: 8px;
            margin: 1rem 0;
        }

        @media (max-width: 768px) {
            .admin-container {
                padding: 1rem;
            }
            
            .stats-grid, .action-grid {
                grid-template-columns: 1fr;
            }
            
            .security-status {
                grid-template-columns: 1fr;
            }
            
            .modal-content {
                width: 95%;
                margin: 2% auto;
            }
        }
    </style>
</head>
<body>
    <div class="admin-container">
        <div class="admin-header">
            <i class="fas fa-shield-alt admin-icon"></i>
            <h1>UNordinary Hub Admin Panel</h1>
            <p>Secure Bot Management Dashboard</p>
        </div>

        <!-- Security Status -->
        <div class="security-status">
            <div class="status-card secure">
                <i class="fas fa-lock"></i>
                <h3>Secure Access</h3>
                <p>Admin session active</p>
            </div>
            <div class="status-card">
                <i class="fas fa-clock"></i>
                <h3>Session Timeout</h3>
                <p id="session-timer">30:00</p>
            </div>
            <div class="status-card">
                <i class="fas fa-heartbeat"></i>
                <h3>System Health</h3>
                <p id="health-status">Checking...</p>
            </div>
        </div>

        <!-- Quick Stats -->
        <div class="stats-grid">
            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-ticket-alt"></i>
                </div>
                <div class="stat-content">
                    <h3 id="open-tickets">-</h3>
                    <p>Open Tickets</p>
                    <small id="total-tickets">Loading...</small>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-user-check"></i>
                </div>
                <div class="stat-content">
                    <h3 id="verified-users">-</h3>
                    <p>Verified Users</p>
                    <small>Total verifications</small>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-server"></i>
                </div>
                <div class="stat-content">
                    <h3 id="configured-servers">-</h3>
                    <p>Configured Servers</p>
                    <small>Active configurations</small>
                </div>
            </div>

            <div class="stat-card">
                <div class="stat-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <div class="stat-content">
                    <h3 id="recent-actions">-</h3>
                    <p>Recent Actions</p>
                    <small>Last 24 hours</small>
                </div>
            </div>
        </div>

        <!-- Admin Actions -->
        <div class="admin-actions">
            <h2><i class="fas fa-cogs"></i> Admin Actions</h2>
            
            <div class="action-grid">
                <div class="action-card">
                    <i class="fas fa-database"></i>
                    <h3>Database Management</h3>
                    <p>Manage bot database and configurations</p>
                    <button onclick="showDatabaseManager()" class="btn btn-primary">Manage</button>
                </div>

                <div class="action-card">
                    <i class="fas fa-users-cog"></i>
                    <h3>User Management</h3>
                    <p>Manage verified users and permissions</p>
                    <button onclick="showUserManager()" class="btn btn-primary">Manage</button>
                </div>

                <div class="action-card">
                    <i class="fas fa-shield-virus"></i>
                    <h3>Security Settings</h3>
                    <p>Configure anti-nuke and security features</p>
                    <button onclick="showSecuritySettings()" class="btn btn-primary">Configure</button>
                </div>

                <div class="action-card">
                    <i class="fas fa-terminal"></i>
                    <h3>Bot Commands</h3>
                    <p>Execute bot commands remotely</p>
                    <button onclick="showBotCommands()" class="btn btn-primary">Execute</button>
                </div>

                <div class="action-card">
                    <i class="fas fa-file-export"></i>
                    <h3>Data Export</h3>
                    <p>Export and import bot data</p>
                    <button onclick="showDataExport()" class="btn btn-primary">Export</button>
                </div>

                <div class="action-card">
                    <i class="fas fa-clipboard-list"></i>
                    <h3>Audit Logs</h3>
                    <p>View system audit logs</p>
                    <button onclick="showAuditLogs()" class="btn btn-primary">View</button>
                </div>
            </div>
        </div>

        <!-- Recent Activity -->
        <div class="recent-activity">
            <h2><i class="fas fa-history"></i> Recent Activity</h2>
            <div class="activity-list" id="activity-list">
                <div class="loading">Loading recent activity...</div>
            </div>
        </div>

        <!-- System Health -->
        <div class="system-health">
            <h2><i class="fas fa-heartbeat"></i> System Health</h2>
            <div class="health-grid" id="health-grid">
                <div class="health-card">
                    <h3>Bot Status</h3>
                    <div class="health-indicator online">
                        <span class="dot"></span>
                        <span>Online</span>
                    </div>
                </div>
                <div class="health-card">
                    <h3>Database</h3>
                    <div class="health-indicator online">
                        <span class="dot"></span>
                        <span>Connected</span>
                    </div>
                </div>
                <div class="health-card">
                    <h3>Web Panel</h3>
                    <div class="health-indicator online">
                        <span class="dot"></span>
                        <span>Active</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Modals -->
    <div id="database-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Database Management</h2>
            <div class="modal-body">
                <div class="db-section">
                    <h3>Backup Database</h3>
                    <button onclick="backupDatabase()" class="btn btn-success">Create Backup</button>
                </div>
                <div class="db-section">
                    <h3>Clear Old Data</h3>
                    <button onclick="clearOldData()" class="btn btn-warning">Clear Data</button>
                </div>
                <div class="db-section">
                    <h3>Export Data</h3>
                    <button onclick="exportData()" class="btn btn-info">Export All Data</button>
                </div>
                <div class="db-section">
                    <h3>Import Data</h3>
                    <input type="file" id="import-file" accept=".json" style="display: none;">
                    <button onclick="document.getElementById('import-file').click()" class="btn btn-secondary">Choose File</button>
                    <button onclick="importData()" class="btn btn-primary">Import Data</button>
                </div>
            </div>
        </div>
    </div>

    <div id="user-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>User Management</h2>
            <div class="modal-body">
                <div class="user-stats">
                    <h3>User Statistics</h3>
                    <div id="user-stats-content">Loading...</div>
                </div>
                <div class="user-list">
                    <h3>Recent Verifications</h3>
                    <div id="verified-users-list">Loading...</div>
                </div>
                <div class="warning-list">
                    <h3>Recent Warnings</h3>
                    <div id="warnings-list">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <div id="security-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Security Settings</h2>
            <div class="modal-body">
                <div class="security-config">
                    <h3>Anti-Nuke Settings</h3>
                    <form id="security-form">
                        <div class="form-group">
                            <label>Ban Limit (per 10 seconds)</label>
                            <input type="number" id="ban-limit" value="2" min="1" max="10">
                        </div>
                        <div class="form-group">
                            <label>Channel Delete Limit (per 10 seconds)</label>
                            <input type="number" id="channel-delete-limit" value="2" min="1" max="10">
                        </div>
                        <div class="form-group">
                            <label>Role Delete Limit (per 10 seconds)</label>
                            <input type="number" id="role-delete-limit" value="2" min="1" max="10">
                        </div>
                        <button type="submit" class="btn btn-primary">Update Settings</button>
                    </form>
                </div>
                <div class="security-events">
                    <h3>Recent Security Events</h3>
                    <div id="security-events-list">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <div id="bot-commands-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Bot Commands</h2>
            <div class="modal-body">
                <div class="command-form">
                    <h3>Execute Bot Command</h3>
                    <form id="bot-command-form">
                        <div class="form-group">
                            <label>Command</label>
                            <select id="command-select">
                                <option value="lockdown">Lockdown Server</option>
                                <option value="unlock">Unlock Server</option>
                                <option value="purge">Purge Messages</option>
                                <option value="ban">Ban User</option>
                                <option value="kick">Kick User</option>
                                <option value="warn">Warn User</option>
                                <option value="clear">Clear Spam</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label>Target (User ID, Channel ID, etc.)</label>
                            <input type="text" id="command-target" placeholder="Enter target...">
                        </div>
                        <button type="submit" class="btn btn-primary">Execute Command</button>
                    </form>
                </div>
                <div class="command-history">
                    <h3>Command History</h3>
                    <div id="command-history-list">No commands executed yet.</div>
                </div>
            </div>
        </div>
    </div>

    <div id="audit-modal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Audit Logs</h2>
            <div class="modal-body">
                <div class="audit-filters">
                    <button onclick="filterAuditLogs('all')" class="btn btn-secondary">All</button>
                    <button onclick="filterAuditLogs('security')" class="btn btn-warning">Security</button>
                    <button onclick="filterAuditLogs('admin')" class="btn btn-info">Admin</button>
                    <button onclick="filterAuditLogs('data')" class="btn btn-success">Data</button>
                </div>
                <div class="audit-logs">
                    <div id="audit-logs-list">Loading...</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration - Update these URLs to your actual web panel endpoints
        const WEB_PANEL_BASE_URL = 'https://www.unordinariness.xyz'; // Your website URL
        const ADMIN_SECRET = 'UNORDINARY_ADMIN_2024_SECURE_KEY_987654321';

        // Session timer
        let sessionTime = 1800; // 30 minutes
        const timerElement = document.getElementById('session-timer');

        function updateTimer() {
            const minutes = Math.floor(sessionTime / 60);
            const seconds = sessionTime % 60;
            timerElement.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            
            if (sessionTime <= 0) {
                window.location.href = '/';
            }
            
            sessionTime--;
        }

        setInterval(updateTimer, 1000);

        // Modal functions
        function showDatabaseManager() {
            document.getElementById('database-modal').style.display = 'block';
        }

        function showUserManager() {
            document.getElementById('user-modal').style.display = 'block';
            loadUserManagementData();
        }

        function showSecuritySettings() {
            document.getElementById('security-modal').style.display = 'block';
            loadSecuritySettings();
        }

        function showBotCommands() {
            document.getElementById('bot-commands-modal').style.display = 'block';
        }

        function showAuditLogs() {
            document.getElementById('audit-modal').style.display = 'block';
            loadAuditLogs();
        }

        // Close modal
        document.querySelectorAll('.close').forEach(closeBtn => {
            closeBtn.onclick = function() {
                this.closest('.modal').style.display = 'none';
            }
        });

        window.onclick = function(event) {
            if (event.target.classList.contains('modal')) {
                event.target.style.display = 'none';
            }
        }

        // API functions with error handling
        async function makeAPIRequest(endpoint, options = {}) {
            try {
                const response = await fetch(`${WEB_PANEL_BASE_URL}${endpoint}`, {
                    ...options,
                    headers: {
                        'Content-Type': 'application/json',
                        ...options.headers
                    }
                });
                
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                return await response.json();
            } catch (error) {
                console.error(`API Error (${endpoint}):`, error);
                throw error;
            }
        }

        // Database functions
        async function backupDatabase() {
            try {
                const data = await makeAPIRequest('/api/admin/backup', { method: 'POST' });
                if (data.success) {
                    alert('Database backup created successfully!');
                } else {
                    alert('Error creating backup: ' + data.error);
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        async function clearOldData() {
            if (confirm('Are you sure you want to clear old data? This action cannot be undone.')) {
                try {
                    const data = await makeAPIRequest('/api/admin/clear-old-data', { method: 'POST' });
                    if (data.success) {
                        alert('Old data cleared successfully!');
                        location.reload();
                    } else {
                        alert('Error clearing data: ' + data.error);
                    }
                } catch (error) {
                    alert('Error: ' + error.message);
                }
            }
        }

        async function exportData() {
            try {
                const data = await makeAPIRequest('/api/admin/export-data');
                if (data.success) {
                    alert(`Data exported successfully to ${data.file}!`);
                } else {
                    alert('Error exporting data: ' + data.error);
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        async function importData() {
            const fileInput = document.getElementById('import-file');
            const file = fileInput.files[0];
            
            if (!file) {
                alert('Please select a file first.');
                return;
            }
            
            const formData = new FormData();
            formData.append('file', file);
            
            try {
                const response = await fetch(`${WEB_PANEL_BASE_URL}/api/admin/import-data`, {
                    method: 'POST',
                    body: formData
                });
                
                const data = await response.json();
                if (data.success) {
                    alert('Data imported successfully!');
                    location.reload();
                } else {
                    alert('Error importing data: ' + data.error);
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        }

        // User management functions
        async function loadUserManagementData() {
            try {
                const data = await makeAPIRequest('/api/admin/user-management');
                
                // Update user stats
                document.getElementById('user-stats-content').innerHTML = `
                    <div class="stat-item">
                        <strong>Total Verified Users:</strong> ${data.total_verified}
                    </div>
                    <div class="stat-item">
                        <strong>Total Warnings:</strong> ${data.total_warnings}
                    </div>
                `;
                
                // Update verified users list
                const verifiedUsersList = document.getElementById('verified-users-list');
                if (data.verified_users.length > 0) {
                    verifiedUsersList.innerHTML = data.verified_users.map(user => `
                        <div class="user-item">
                            <strong>User ID:</strong> ${user.user_id}<br>
                            <small>Verified: ${user.verified_at}</small>
                        </div>
                    `).join('');
                } else {
                    verifiedUsersList.innerHTML = '<p>No verified users found.</p>';
                }
                
                // Update warnings list
                const warningsList = document.getElementById('warnings-list');
                if (data.recent_warnings.length > 0) {
                    warningsList.innerHTML = data.recent_warnings.map(warning => `
                        <div class="warning-item">
                            <strong>User ID:</strong> ${warning.user_id}<br>
                            <strong>Reason:</strong> ${warning.reason}<br>
                            <small>Date: ${warning.timestamp}</small>
                        </div>
                    `).join('');
                } else {
                    warningsList.innerHTML = '<p>No recent warnings found.</p>';
                }
            } catch (error) {
                document.getElementById('user-stats-content').innerHTML = '<div class="error-message">Error loading user data</div>';
            }
        }

        // Security settings functions
        async function loadSecuritySettings() {
            try {
                const data = await makeAPIRequest('/api/admin/security-settings');
                
                // Update security events
                const securityEventsList = document.getElementById('security-events-list');
                if (data.security_events.length > 0) {
                    securityEventsList.innerHTML = data.security_events.map(event => `
                        <div class="security-event">
                            <strong>Type:</strong> ${event.action_type}<br>
                            <strong>User ID:</strong> ${event.user_id}<br>
                            <strong>Details:</strong> ${event.details}<br>
                            <small>Time: ${event.timestamp}</small>
                        </div>
                    `).join('');
                } else {
                    securityEventsList.innerHTML = '<p>No recent security events found.</p>';
                }
            } catch (error) {
                document.getElementById('security-events-list').innerHTML = '<div class="error-message">Error loading security data</div>';
            }
        }

        // Bot commands functions
        document.getElementById('bot-command-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const command = document.getElementById('command-select').value;
            const target = document.getElementById('command-target').value;
            
            try {
                const data = await makeAPIRequest('/api/admin/bot-commands', {
                    method: 'POST',
                    body: JSON.stringify({
                        command: command,
                        target: target
                    })
                });
                
                if (data.success) {
                    alert(`Command executed: ${data.message}`);
                    // Add to command history
                    const historyList = document.getElementById('command-history-list');
                    const historyItem = document.createElement('div');
                    historyItem.innerHTML = `
                        <div class="command-item">
                            <strong>${data.command}</strong> on ${data.target}<br>
                            <small>Result: ${data.message}</small>
                        </div>
                    `;
                    historyList.appendChild(historyItem);
                } else {
                    alert('Error executing command: ' + data.error);
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        });

        // Audit logs functions
        async function loadAuditLogs() {
            try {
                const data = await makeAPIRequest('/api/admin/audit-logs');
                const logsList = document.getElementById('audit-logs-list');
                
                if (data.logs.length > 0) {
                    logsList.innerHTML = data.logs.map(log => `
                        <div class="log-entry">
                            <div class="log-time">${log.timestamp}</div>
                            <div class="log-action">${log.action}</div>
                            <div class="log-details">${log.details || 'No details'}</div>
                        </div>
                    `).join('');
                } else {
                    logsList.innerHTML = '<p>No audit logs found.</p>';
                }
            } catch (error) {
                document.getElementById('audit-logs-list').innerHTML = '<div class="error-message">Error loading audit logs</div>';
            }
        }

        function filterAuditLogs(filter) {
            console.log('Filtering audit logs by:', filter);
        }

        // Security settings form
        document.getElementById('security-form').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                guild_id: 1, // Default guild ID
                anti_nuke_thresholds: {
                    ban_limit: parseInt(document.getElementById('ban-limit').value),
                    channel_delete_limit: parseInt(document.getElementById('channel-delete-limit').value),
                    role_delete_limit: parseInt(document.getElementById('role-delete-limit').value)
                }
            };
            
            try {
                const data = await makeAPIRequest('/api/admin/update-security', {
                    method: 'POST',
                    body: JSON.stringify(formData)
                });
                
                if (data.success) {
                    alert('Security settings updated successfully!');
                } else {
                    alert('Error updating security settings: ' + data.error);
                }
            } catch (error) {
                alert('Error: ' + error.message);
            }
        });

        // Update stats periodically
        async function updateStats() {
            try {
                const statsData = await makeAPIRequest('/api/admin/stats');
                const healthData = await makeAPIRequest('/api/admin/system-health');
                
                // Update stats
                if (statsData.recent_actions !== undefined) {
                    document.getElementById('recent-actions').textContent = statsData.recent_actions;
                }
                if (statsData.open_tickets !== undefined) {
                    document.getElementById('open-tickets').textContent = statsData.open_tickets;
                }
                if (statsData.recent_verifications !== undefined) {
                    document.getElementById('verified-users').textContent = statsData.recent_verifications;
                }
                
                // Update health status
                const healthStatus = document.getElementById('health-status');
                if (healthData.health_status === 'healthy') {
                    healthStatus.textContent = 'Healthy';
                    healthStatus.style.color = '#4CAF50';
                } else if (healthData.health_status === 'warning') {
                    healthStatus.textContent = 'Warning';
                    healthStatus.style.color = '#ffc107';
                } else {
                    healthStatus.textContent = 'Critical';
                    healthStatus.style.color = '#dc3545';
                }
                
                // Update health indicators
                const botStatus = document.querySelector('#health-grid .health-indicator');
                if (healthData.bot_running) {
                    botStatus.className = 'health-indicator online';
                    botStatus.querySelector('span:last-child').textContent = 'Online';
                } else {
                    botStatus.className = 'health-indicator critical';
                    botStatus.querySelector('span:last-child').textContent = 'Offline';
                }
                
                // Update activity list
                updateActivityList();
                
            } catch (error) {
                console.error('Error updating stats:', error);
                document.getElementById('health-status').textContent = 'Error';
                document.getElementById('health-status').style.color = '#dc3545';
            }
        }

        async function updateActivityList() {
            try {
                const data = await makeAPIRequest('/api/admin/stats');
                const activityList = document.getElementById('activity-list');
                
                if (data.recent_actions && data.recent_actions > 0) {
                    activityList.innerHTML = `
                        <div class="activity-item">
                            <div class="activity-icon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="activity-content">
                                <h4>Recent Activity</h4>
                                <p>${data.recent_actions} actions in last 24 hours</p>
                            </div>
                        </div>
                    `;
                } else {
                    activityList.innerHTML = '<div class="loading">No recent activity</div>';
                }
            } catch (error) {
                document.getElementById('activity-list').innerHTML = '<div class="error-message">Error loading activity</div>';
            }
        }

        // Initialize
        updateStats();
        setInterval(updateStats, 30000);

        // Security: Hide this page from search engines
        const meta = document.createElement('meta');
        meta.name = 'robots';
        meta.content = 'noindex, nofollow';
        document.head.appendChild(meta);
    </script>
</body>
</html> 